{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">

<div class="container">

<h1>ðŸ”‘ Generate Voter Token</h1>

<form method="POST">
    {% csrf_token %}
    <label>Number of tokens:</label>
<input type="number" name="voter_quantity" min="1" value="1" required>

    <h3>Token Permissions</h3>

    <label>
        <input type="checkbox" name="all_positions" id="allCheck">
        Allow voting for ALL positions
    </label>

    <h4>Or Select Positions:</h4>

    {% for position in positions %}
        <label>
            <input type="checkbox" name="positions" value="{{ position.id }}">
            {{ position.name }}
        </label><br>
    {% endfor %}

    <br>
    <button type="submit" name="generate_voters">Generate Token</button>
</form>

<hr>
<h2>copy</h2>
 {% for token in generated_tokens %}
        <input type="text" value="{{ token }}" readonly>
        <button onclick="navigator.clipboard.writeText('{{ token }}')">
            Copy
        </button>
        <br>
    {% endfor %}

{% if generated_tokens %}
    <h3>Generated Voter Tokens</h3>
    {% for token in generated_tokens %}
        <input type="text" value="{{ token }}" readonly>
        <button onclick="navigator.clipboard.writeText('{{ token }}')">
            Copy
        </button>
        <br>
    {% endfor %}
{% endif %}
<hr>

<h2>Generate Campaign Manager Token</h2>

<form method="POST">
    {% csrf_token %}
    <label>Number of tokens:</label>
    <input type="number" name="quantity" min="1" value="1" required>

    <label>Select Candidate:</label>
    <select name="candidate" required>
        {% for candidate in candidates %}
            <option value="{{ candidate.id }}">
                {{ candidate.name }} ({{ candidate.position.name }})
            </option>
        {% endfor %}
    </select>

    <button type="submit" name="generate_manager">
        Generate Manager Token
    </button>
</form>

{% if manager_token %}
    <h3>Manager Token Created</h3>
    <input type="text" value="{{ manager_token }}" readonly>
    <button onclick="navigator.clipboard.writeText('{{ manager_token }}')">
        Copy
    </button>
{% endif %}

<h2>All Tokens</h2>
<p>DEBUG: {{ generated_token }}</p>

{% for token in tokens %}
<div class="token-card">
    <input type="text" value="{{ token.token }}" id="token{{ token.id }}" readonly>
    <button type="button" onclick="copyToken('token{{ token.id }}')">
        ðŸ“‹ Copy
    </button>

    {% if token.is_active %}
        <span class="active">Active</span>
    {% else %}
        <span class="inactive">Used</span>
    {% endif %}
</div>
{% endfor %}

</div>

<script>
function copyToken(id) {
    const input = document.getElementById(id);
    navigator.clipboard.writeText(input.value);
}
</script>